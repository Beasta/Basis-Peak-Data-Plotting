
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>jQuery-CSV - Basic Usage Demo</title>

  <!-- <script src="jquery-1.11.2.js"></script>
  <link href="jquery-ui.css" rel="stylesheet" />
  <script src="jquery-ui.js"></script>
  <script src="jquery.csv-0.71.js"></script> -->

  <script src="https://code.jquery.com/jquery-1.11.2.js"></script>
  <link href="https://code.jquery.com/ui/1.9.0/themes/cupertino/jquery-ui.css" rel="stylesheet" />
  <script src="https://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>
  <script src="https://jquery-csv.googlecode.com/files/jquery.csv-0.71.js"></script>
  <!--Load the AJAX API-->
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script src="fileReader_forBasis.js"></script>
  <script src="htmlTablefromArray.js"></script>
  <script src="dateFixer.js"></script>
  <script src="averagerFunction.js"></script>
  
  <script>
    var arrayBeast=[]; //array for all data
     var globalBeast=""//"date,calories,gsr,heart-rate,skin-temp,steps\
                  // This is an exampe of what the csv file looks like
                  //   2014-11-25 05:40Z,0.1,,,,0\
                  //   2014-11-25 05:41Z,1.1,,,,0\
                  //   2014-11-25 05:42Z,1.2,,,,0\
                  //   2014-11-25 05:43Z,1.1,,,,0\
                  //   2014-11-25 05:44Z,1.1,,,,0\
                  //   2014-11-25 05:45Z,1,,,,0\
                  //   2014-11-25 05:46Z,1.4,,64,,0\
                  //   2014-11-25 05:47Z,1.3,4.56605e-05,64,77.9,6\
                  //   2014-11-25 05:48Z,1.4,4.56605e-05,63,78.8,0\
                  //   2014-11-25 05:49Z,1.1,4.49086e-05,65,78.8,0\
                  //   2014-11-25 05:50Z,1.2,4.54085e-05,66,79.7,0\
                  //   2014-11-25 05:51Z,1.3,4.49086e-05,64,79.7,0\
                  //   2014-11-25 05:52Z,1.1,4.49086e-05,64,79.7,0\
                  //   2014-11-25 05:53Z,1.2,4.49086e-05,64,79.7,0"; //string for raw csv input, using this data so i don't have to load every time
    //$('#input2').val(globalBeast); // add starting data to the input box 
    


      // Load the Visualization API and the piechart package.
      google.load('visualization', '1.0', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      //google.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        // data.addColumn('string', 'Topping');
        // data.addColumn('number', 'Slices');
        // data.addRows([
        //   ['Mushrooms', 3],
        //   ['Onions', 1],
        //   ['Olives', 1],
        //   ['Zucchini', 1],
        //   ['Pepperoni', 2]
        // ]);
        var columnsCounter=0;
        for(i=0;i<1;i++){
          data.addColumn('number',arrayBeast[0][i]);
          console.log(arrayBeast[0][i]+"   i:"+i);
          //columnsCounter++;
        };
        for(i=1;i<arrayBeast[0].length;i++){
          data.addColumn('number',arrayBeast[0][i]);
          console.log(arrayBeast[0][i]+"   i:"+i);
          columnsCounter++;
        };        
        console.log("columnsCounter;"+columnsCounter);
          // data.addColumn('string',arrayBeast[1][i]);
          // data.addColumn('string',arrayBeast[2][i]);
          // data.addColumn('string',arrayBeast[3][i]);
          // data.addColumn('string',arrayBeast[4][i]);
          // data.addColumn('string',arrayBeast[5][i]);
          // data.addColumn('number',arrayBeast[6][i]);
          // data.addColumn('number',arrayBeast[7][i]);
          // data.addColumn('number',arrayBeast[8][i]);
          // data.addColumn('number',arrayBeast[9][i]);
          // data.addColumn('number',arrayBeast[10][i]);
        //}



        for(i=1;i<arrayBeast.length;i++){
          arrayBeast[i][0]=0;
          for(x=1;x<arrayBeast[i].length;x++){
            if (arrayBeast[i][x]==="") {
              arrayBeast[i][x]=0;
            }else{
              arrayBeast[i][x]=Number(arrayBeast[i][x]);
            }

          }
          console.log(arrayBeast[i]);
          
        }
        throwAway=arrayBeast.shift();
          console.log(arrayBeast);
          data.addRows(arrayBeast);
        //var data=google.visualization.arrayToDataTable(arrayBeast);

        // Set chart options
        var options = {'title':'How Much Pizza I Ate Last Night',
                       'width':500,
                       'height':500};

        // Instantiate and draw our chart, passing in some options.
        //var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
        var table = new google.visualization.Table(document.getElementById('table_div'));

        table.draw(data, {showRowNumber: true});

        //chart.draw(data, options);

      }


    $(function() {
      $("#tabs").tabs();
    });

    $(document).ready(function() {
      
      //example2();
      
      
      
      $('#run2').bind('click', function() {
        example2();
        //averager(arrayBeast,8,3); //6 is year, 7 is month, 8 is day, 9 is hour, 10 is minute, 3 is heartRate,
        drawChart();
      });
      
    });


    function example2() {
      
      var input = globalBeast;//$('#input2').val(); //global beast is string
      
      
      arrayBeast = $.csv.toArrays(input); // change global beast string into an array
      
      var header = arrayBeast.shift(); //remove header row
       // console.log(arrayBeast[0][6]);
       // arrayBeast[0][6]="year";
       // console.log(arrayBeast[0][6]);
       // header.push("month");
       // header.push("day");
       // header.push("hour");
       // header.push("minute");
       // console.log(header);
       // arrayBeast.unshift(header);
       // console.log(arrayBeast);
  
      // console.log(arrayBeast[0][5]+"   06   " + arrayBeast[0][6]);
      arrayBeast=dateFixer(arrayBeast);//breaks date up into year,month,day, and adds them as columns in array
      header[6]="year";
      header[7]="motnh";
      header[8]="day";
      header[9]="hour";
      header[10]="minute";
      var throwAway=arrayBeast.unshift(header);
      
      var html = generateTable(arrayBeast);

      $('#result2').empty(); //empty previous data from table
      $('#result2').html(html); //fill table with html data created by generateTable
      
    }

  </script>


  <style>
    textarea {
      width:100%;
    }
    .result {
        width:100%;
        overflow:auto;
    } 
    td {
      padding:5px;
    }
  </style>


</head>

<body>

<article>
        <label for="files">Select a file: </label>
        <input id="files" type="file" />
        <output id="result" />
</article>

<div id=tabs>

  <div id=tabs-3>
    
    <hr />
    <h4>Input Data:</h4>
    <textarea id=input2 style="height:150px;"></textarea>

    <input id=run2 type=button value="Run" />
    <hr />
    <h4>Result:</h4>
    <div class=result>
      <table id=result2 border=1></table>
    </div>
  </div>
  <!--Div that will hold the pie chart-->
    <div id="chart_div"></div>
    <div id="table_div"></div>
</body>
</html>
